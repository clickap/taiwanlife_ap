(function(e){$type=String,$type.__typeName="String",$type.__class=!0,$prototype=$type.prototype,$prototype.endsWith=function(t){return this.substr(this.length-t.length)===t},$prototype.startsWith=function(t){return this.substr(0,t.length)===t},$prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")},$prototype.trimEnd=function(){return this.replace(/\s+$/,"")},$prototype.trimStart=function(){return this.replace(/^\s+/,"")},$type.format=function(t,n){return String._toFormattedString(!1,arguments)},$type._toFormattedString=function(t,n){var r="",i=n[0];for(var s=0;;){var o=i.indexOf("{",s),u=i.indexOf("}",s);if(o<0&&u<0){r+=i.slice(s);break}if(u>0&&(u<o||o<0)){if(i.charAt(u+1)!=="}")throw new Error("format stringFormatBraceMismatch");r+=i.slice(s,u+1),s=u+2;continue}r+=i.slice(s,o),s=o+1;if(i.charAt(s)==="{"){r+="{",s++;continue}if(u<0)throw new Error("format stringFormatBraceMismatch");var a=i.substring(s,u),f=a.indexOf(":"),l=parseInt(f<0?a:a.substring(0,f),10)+1;if(isNaN(l))throw new Error("format stringFormatInvalid");var c=f<0?"":a.substring(f+1),h=n[l];if(typeof h=="undefined"||h===null)h="";h.toFormattedString?r+=h.toFormattedString(c):t&&h.localeFormat?r+=h.localeFormat(c):h.format?r+=h.format(c):r+=h.toString(),s=u+1}return r}})(window),YUI.add("moodle-mod_videoquiz-video",function(e,t){(function(t){var n,r={markerStyle:{width:"7px","border-radius":"30%","background-color":"yellow"},newMarkerStyle:{width:"7px","border-radius":"30%","background-color":"red"},markerTip:{display:!0,default_text:"Q: "},breakOverlay:{display:!1,display_time:2,default_text:"Break overlay",style:{width:"100%",height:"20%","background-color":"rgba(0,0,0,0.7)",color:"white","font-size":"17px"}}},i=function(e,t){this.player=e,this.duration=0,this.nativeKeys=Object.keys,this.markers=[],this.markNodeList=[],this.editmode="off",this.tipmode="off",this.setting=r,this.sliders=t,this.video=document.querySelector("video"),this.overlay_index=-1,n=this;var i=n.getTechName(e);M.cfg.developerdebug,loadedmetadata!==!0||i.toLowerCase()!=="html5"&&i.toLowerCase()!=="hls"?this.player.on("loadedmetadata",function(){n.duration=n.player.duration(),n.createCuepoint(),n.bindCuepoint(),n.marktip=n.createMarkTip()}):(n.duration=n.player.duration(),n.createCuepoint(t),n.bindCuepoint(),n.marktip=n.createMarkTip())};i.prototype.getTechName=function(e){for(var t=0;t<e.options().techOrder.length;t++){var n=e.options().techOrder[t],r=n.charAt(0).toUpperCase()+n.slice(1);if(videojs[r].isSupported())return r}},i.prototype.createCuepoint=function(t){var r,i;t=t||this.sliders,M.cfg.developerdebug,e.all(".vjs-marker").remove(),this.markNodeList.splice(0,this.markNodeList.length),this.markers.splice(0,this.markers.length);for(key in t)r=t[key],i=n.addCuepoint(r),i&&(e.one(".vjs-progress-control").append(i),this.markNodeList[r.id]=i)},i.prototype.clearCuepoint=function(){M.cfg.developerdebug,e.all(".vjs-marker").remove(),this.markNodeList.splice(0,this.markNodeList.length),this.markers.splice(0,this.markers.length),this.player.off("timeupdate",this.cueTimeHandle)},i.prototype.addCuepoint=function(t){var r,i,s,o,u=parseFloat(t.time);return u>0?(r=t.question,i=u/this.duration*100,i>100?null:(s=t.options,corrects=t.corrects||t.rightitems,this.markers[t.id]={id:t.id,pos:i,time:u,question:r,options:s,rightitems:corrects},o=e.Node.create("<div class='vjs-marker'  id='"+t.id+"'></div>"),n.editmode==="off"?o.setStyles(this.setting.markerStyle):(o.setStyles(this.setting.newMarkerStyle),o.on("click",n.showMarkHandle,n,n.markers)),o.setStyle("margin-left",-parseFloat(o.getStyle("width"))/2+"px"),o.setStyle("left",i+"%"),o)):null},i.prototype.removeCuepoint=function(t){this.markers.splice(t,1),m=this.markNodeList[t],e.one(".vjs-progress-control").removeChild(m),this.markNodeList.splice(t,1)},i.prototype.showMarkHandle=function(e,t){var r=e.target;e.preventDefault&&e.preventDefault();var i=parseInt(e.target.get("id"),10);n.showEditDialog(i,t[i])},i.prototype.showQDialog=function(t,r){var i=n.markers[t];e.use("videoquiz_question_dialog",function(e){this.qDialog=M.mod_videoquiz.quesion_qdialog.init({markid:t,question:i,hostid:n.player.id(),width:n.player.width()+"px",heading:M.util.get_string("dialogheading","videoquiz"),cancellabel:M.str.videoquiz.abortanswer,submitlabel:M.util.get_string("submitlabel","videoquiz"),correctlabel:M.str.videoquiz.rightanswer,incorrectlabel:M.str.videoquiz.wronganswer,continuelabel:M.str.videoquiz.continuewatch,correctanswerstr:M.str.videoquiz.correctanswerstr,incorrectanswerstr:M.str.videoquiz.wronganswerstr,abortanswerstr:M.str.videoquiz.abortanswerstr,show:function(){n.player.pause()}}),this.qDialog.on("answer_correct",function(){n.player.play()}),this.qDialog.on("answer_incorrect",function(){n.player.play()}),this.qDialog.on("answer_abort",function(){n.player.play()})})},i.prototype.showEditDialog=function(t){var r,i,s={},o,u={question:"",time:n.player.currentTime(),options:[M.str.videoquiz.itemplacehold+"1",M.str.videoquiz.itemplacehold+"2"]};t>=0?(i=n.markers[t],r=!1):(i=u,r=!0),s.cancellabel=s.cancellabel?s.cancellabel:M.str.moodle.cancel,s.submitlabel=M.util.get_string("submitlabel","videoquiz"),s.heading=s.heading?s.heading:M.util.get_string("dialogheading","videoquiz"),s.validating=s.validating?s.validating:M.util.get_string("editvalidating","videoquiz"),s.optionlabel=M.util.get_string("option","videoquiz"),e.use("yui2-container","yui2-event","yui2-animation","yui2-connection","yui2-editor","yui2-dragdrop",function(e){var u=function(t){var r=confirm(M.str.videoquiz.confirmdelquestion);if(r)var i=e.io("delete.php",{method:"GET",data:{sesskey:M.cfg.sesskey,id:t},on:{success:function(){n.removeCuepoint(t),l.hide()},failue:function(e){alert("failure")}}})},a=function(s){var u=e.JSON.parse(s.responseText);u.success&&(i.id=u.question_id,r?(o=n.addCuepoint(i),e.one(".vjs-progress-control").append(o),n.markNodeList[i.id]=o):n.markers[t]=i,n.createCuepoint(n.markers.concat()))},f=function(e){alert("Submission failed: "+
e.status)},l=new e.YUI2.widget.Dialog("editdialog",{width:n.player.width()+"px",fixedcenter:!0,close:!1,modal:!0,visible:!1,buttons:[{text:s.cancellabel,handler:function(){l.hide()}},{text:M.str.videoquiz.deletequestion,handler:function(){u(t)}},{text:s.submitlabel,handler:function(){var t=l.form.elements;g.saveHTML(),i.question=g.get("element").value,i.time=t.time.value;var r=e.one(l.form).one("div#quiz_options").all("input[id^=answer]")._nodes,s=e.one(l.form).one("div#quiz_options").all("input[type=checkbox]")._nodes,o=new Array(r.length),u=new Array(r.length),a=[];for(var f=0;f<r.length;f++)o[f]=r[f].value,u[f]=s[f].checked?1:0,s[f].checked&&a.push(f);i.options=o,i.rightitems=u,optionsJson=e.JSON.stringify(i.options),correctsJson=e.JSON.stringify(a);var c="video_id={0}&corrects={1}&options={2}",h=String.format(c,n.player.video_id,correctsJson,optionsJson);l.cfg.setProperty("postdata",h),l.submit()},isDefault:!0}]});l.setHeader(s.heading),l.setBody(e.Node.create("<div></div>")._node.innerHTML),e.one(l.form).addClass("form-horizontal"),l.form.setAttribute("action","save_question.php");var c="float: left; width: 25%;";l.form.appendChild(e.Node.create('<textarea id="editor" name="question" rows="3" cols=40 placeholder="Type the question...">'+i.question+"</textarea><br/>")._node),l.form.appendChild(e.Node.create('<input type="hidden" name="questiong_id" value="'+i.id+'" />')._node),l.form.appendChild(e.Node.create('<label for="time" style="'+c+'">'+M.str.videoquiz.prompttime+':</label><input type="textbox" name="time" value="'+i.time+'" />')._node),l.form.appendChild(e.Node.create('<div style="float:right" ><button type="button" id="locationAddButton">'+M.str.videoquiz.addoption+"</button></div>")._node);var h=e.Node.create('<div class="bs-docs-example" id="quiz_options" ></div>'),p,d,v,m='<div class="control-group yui-gd">';m+='<label class="control-label yui-u first" for="answer{0}" >{1}</label>',m+='<div class="controls yui-u" id="option{0}" opt-key={0} >',m+='<input type="textbox" id="answer{0}" name="answers{0}" value="{2}" />',m+='<input type="checkbox" id="correct{0}" name="checkbox" value="1" {4} ><label for="correct{0}"><span></span>{3}</label>',m+="</div></div>";for(key in i.options)p=parseInt(key,10),d=M.str.videoquiz.option+(p+1),correctAns="",i.rightitems&&(correctAns=Boolean(i.rightitems[key]==1)?"checked":""),v=e.Node.create(String.format(m,p,d,i.options[p],M.str.videoquiz.correctanswer,correctAns)),h.appendChild(v);l.form.appendChild(h._node),l.validate=function(){var e=l.getData(),t=parseFloat(e.time);return g.saveHTML(),e.question=g.get("element").value,e.question===""||t<=0?(alert(s.validating),!1):!0},l.showEvent.subscribe(function(){var t=e.Node.create('<span class="remove" id="remove'+key+'"></span>');e.use("option-add-remove",function(e){var t=new e.addRemove({addBtnNode:e.one("#locationAddButton"),optionNodes:e.all("div.controls[id^=option]"),targetNode:e.one("div#quiz_options"),animate:!0,templateString:m})})}),l.hideEvent.subscribe(function(e){}),l.callback={success:a,failure:f},l.render(document.body);var g=new e.YUI2.widget.SimpleEditor("editor",{height:"120px",titlebar:!1,focusAtStart:!0,toolbar:{grouplabels:!1,buttons:[{group:"textstyle",label:"Font Style",buttons:[{type:"select",label:"Arial",value:"fontname",disabled:!0,menu:[{text:"Arial",checked:!0},{text:"Arial Black"},{text:"Comic Sans MS"},{text:"Courier New"},{text:"Lucida Console"},{text:"Tahoma"},{text:"Times New Roman"},{text:"Trebuchet MS"},{text:"Verdana"}]},{type:"spin",label:"13",value:"fontsize",range:[9,75],disabled:!0},{type:"separator"},{type:"push",label:"Bold",value:"bold"},{type:"push",label:"Italic",value:"italic"},{type:"push",label:"Underline",value:"underline"},{type:"separator"},{type:"color",label:"Font Color",value:"forecolor",disabled:!0},{type:"color",label:"Background Color",value:"backcolor",disabled:!0}]}]}});g.render(),n.player.pause(),l.show()})},i.prototype.editOn=function(){if(n.editmode==="off"){var t=e.all(".vjs-marker")._nodes;e.Array.each(t,function(e){e.style.setProperty("background-color","red")}),e.all(".vjs-marker").on("click",n.showMarkHandle,n,n.markers),n.editmode="on"}},i.prototype.editOff=function(){if(n.editmode=="on"){var t=e.all(".vjs-marker")._nodes;e.Array.each(t,function(e){e.style.setProperty("background-color","yellow")}),e.all(".vjs-marker").detach("click",n.showMarkHandle),n.editmode="off"}},i.prototype.createMarkTip=function(){var t;return M.cfg.developerdebug,t=e.Node.create("<div class='vjs-tip'><div class='vjs-tip-arrow'></div><div class='vjs-tip-inner'></div></div>"),e.one(".vjs-progress-control").append(t),t},i.prototype.tipOn=function(){n.tipmode=="off"&&(e.all(".vjs-marker").on("mouseover",function(t){var r=parseInt(t.target.get("id"),10);e.one(".vjs-tip-inner").setContent(n.setting.markerTip.default_text+": "+n.markers[r].question),n.marktip.setStyles({left:n.markers[r].pos+"%","margin-left":-parseFloat(n.marktip.getStyle("width"))/2-5+"px",visibility:"visible"})}),e.all(".vjs-marker").on("mouseout",function(){n.marktip.setStyle("visibility","hidden")}),n.tipmode="on")},i.prototype.tipOff=function(){n.tipmode=="on"&&(e.all(".vjs-marker").detach("mouseover"),e.all(".vjs-marker").detach("mouseout"),n.tipmode="off")},i.prototype.events=function(){},i.prototype.currentTime=function(){return this.player.currentTime},i.prototype.setTime=function(e){return this.time=e,this.player.currentTime=e,this.player.play()},i.prototype.cueTimeHandle=function(){ct=n.player.currentTime();if(n.overlay_index==-1)for(var e in n.markers){var t=n.markers[e],r=parseInt(e,10);ct>=t.time&&ct<=t.time+n.setting.breakOverlay.display_time&&(n.overlay_index=r,n.showQDialog(r,t))}else if(ct<n.markers[n.overlay_index].time||ct>n.markers[n.overlay_index].time+n.setting.breakOverlay.display_time)n.overlay_index=-1},i.prototype.bindCuepoint=function(){var e=this;M.cfg.developerdebug,this.timeupdateSub=this.player.on("timeupdate",e.cueTimeHandle)},i.prototype.untieCuepoint=function(
){M.cfg.developerdebug,this.player.off("timeupdate",this.cueTimeHandle)},i.prototype.play=function(){return this.player.play()},i.prototype.pause=function(){if(!this.player.paused)return this.player.pause()},videojs.plugin("videoquiz",function(e,t){this.quiz=this.quiz||{},this.video_id=e,this.quiz=new i(this,t)})})(window.videojs),YUI.add("videoquiz_question_dialog",function(e){function t(e){t.superclass.constructor.apply(this,arguments)}t.NAME="VidoeQuestionDialog",t.ATTRS={markid:{validator:e.Lang.isNumber,value:null},question:{},hostid:{},width:{},cancellabel:{validator:e.Lang.isString,value:"Abort"},submitlabel:{},heading:{validator:e.Lang.isString,value:"Question Dialog"},correctlabel:{validator:e.Lang.isString,value:"Correct!"},incorrectlabel:{validator:e.Lang.isString,value:"Wrong !!"},continuelabel:{validator:e.Lang.isString,value:"Continue"},correctanswerstr:{validator:e.Lang.isString,value:"Correct!"},incorrectanswerstr:{validator:e.Lang.isString,value:"Oops, Incorrect!!"},abortanswerstr:{validator:e.Lang.isString,value:"aww! don't give up too easy!!"},show:{},submit:{}},e.extend(t,e.Base,{_abortAnswer:!1,_action:"ajax/submit_answer.php",abortFooterHtml:"",footerHtml:"",correctFooterHtml:"",wrongFooterHtml:"",initializer:function(t,n,r,i){this.publish("answer_right"),this.publish("answer_wrong"),this.publish("answer_abort"),this.markid=this.get("markid"),this.question=this.get("question"),this.qdialog=new e.YUI2.widget.Dialog("qdialog",{width:t.width,monitorresize:!0,context:[t.hostid,"tl","tl",["windowResize"]],icon:e.YUI2.widget.SimpleDialog.ICON_HELP,modal:!0,visible:!1,close:!1,draggable:!1,constraintoviewport:!0,buttons:[{text:this.get("cancellabel"),handler:this.handleAbort},{text:this.get("submitlabel"),handler:this.handleSubmit,isDefault:!0}]}),this.qdialog.qpanel=this,this.qdialog.questionid=this.question.id,this.qdialog.showEvent.subscribe(t.show),this.qdialog.cfg.setProperty("keylisteners",[new e.YUI2.util.KeyListener(document,{keys:[13]},{fn:this.handleSubmit,scope:this.qdialog,correctScope:!0})]),this.qdialog.setHeader(this.get("heading"));var s=e.Node.create("<div >"+this.question.question+"</div>");this.qdialog.setBody(s._node.innerHTML),this.qdialog.form.setAttribute("action","ajax/submit_answer.php");var o=e.Node.create(this.qdialog.form),u='<div>&nbsp;&nbsp;&nbsp;<input type="radio" name="answers" class="css-checkbox" id="answers_{0}" value={0} />';u+='<label for="answers_{0}"><span></span>{1}</label></div>';var a;for(idx in this.question.options)a=String.format(u,idx,this.question.options[idx]),this.qdialog.form.appendChild(e.Node.create(a)._node);this.qdialog.callback={success:this.handleSuccess,failure:this.handleFailure,argument:this},this.qdialog.render(document.body),this.qdialog.show(),this.abortFooterHtml='<span id="qdialog_abort_close" class="yui-button default"><span class="first-child"><button type="button">'+this.get("continuelabel")+"</button></span></span>",this.abortFooterHtml+='<span class="progress"><img src="'+M.cfg.loadingicon+'" />.....</span>',this.abortFooterHtml+='<div class="message">'+this.get("abortanswerstr")+'</div> <div style="clear:both"></div>',this.footerHtml='<span id="qdialog_close" class="yui-button-disabled"><span class="first-child"><button type="button">'+this.get("continuelabel")+"</button></span></span>",this.footerHtml+='<span class="progress"><img src="'+M.cfg.loadingicon+'" />.....</span>',this.footerHtml+='<div id="correctstr" class="message"><img src="'+M.util.image_url("i/tick_green_big")+'" />'+this.get("correctanswerstr")+"</div>",this.footerHtml+='<div id="wrongstr" class="message"><img src="'+M.util.image_url("i/cross_red_big")+'" />'+this.get("incorrectanswerstr")+"</div>",this.footerHtml+='<div style="clear:both"></div>',this.correctFooterHtml='<span id="qdialog_correct_close" class="yui-button default"><span class="first-child"><button type="button">'+this.get("continuelabel")+"</button></span></span>",this.correctFooterHtml+='<div class="message"><img src="'+M.util.image_url("i/tick_green_big")+'" />'+this.get("correctanswerstr")+'</div> <div style="clear:both"></div>',this.wrongFooterHtml='<span id="qdialog_incorrect_close" class="yui-button default"><span class="first-child"><button type="button">'+this.get("continuelabel")+"</button></span></span>",this.wrongFooterHtml+='<div class="message"><img src="'+M.util.image_url("i/cross_red_big")+'" />'+this.get("incorrectanswerstr")+'</div> <div style="clear:both"></div>'},destructor:function(){oButton.destory(),this.qdialog.destroy()},initDefaultConfig:function(){},show:function(){this.qdialog.show()},handleSubmit:function(){var t="questionid="+this.markid,n=this.form.elements,r=this.getData();r.questionid=this.questionid,r.sesskey=M.cfg.sesskey;var i=function(t,n,r){var t=t,i=n.responseText,s=r[0];s.resultDialog||(s.resultDialog=new e.YUI2.widget.Overlay("result_dialog",{container:s.qdialog.element,zIndex:6,modal:!1,monitorresize:!0,context:[s.qdialog.element,"tr","tr",["beforeShow","windowResize"]],width:"200px",height:"200px",constraintoviewport:!0,visible:!1}),s.resultDialog.setBody('<div class="message"><img src="'+M.util.image_url("i/tick_green_big")+'" /></div>'),s.resultDialog.render(document.body));var o=e.one("span.progress");o&&o.hide();var u=e.one(s.qdialog.form),a=e.JSON.parse(n.responseText);if(!a.abort)if(a.success){var f=a.rightanswer.split(",");e.one("span#qdialog_close").removeClass("yui-button-disabled"),e.one("span#qdialog_close").addClass("default"),s.correctButton=new e.YUI2.widget.Button("qdialog_close",{type:"submit"}),e.one("div#correctstr").show(),s.correctButton.on("click",function(e,t,n){s.qdialog.hide(),s.fire("answer_correct")});for(idx in f)u.all("label").each(function(e){e.get("innerText")==f[idx]&&e.addClass("correct")})}else{var f=a.rightanswer.split(",");e.one("span#qdialog_close").removeClass("yui-button-disabled"),e.one("span#qdialog_close").addClass("default"),s.incorrectButton=new e.YUI2.widget.Button("qdialog_close",{type
:"submit"}),e.one("div#wrongstr").show(),s.incorrectButton.on("click",function(e,t,n){s.qdialog.hide(),s.fire("answer_correct")});var l;for(idx in f)u.all("label").each(function(e){l=e.get("text"),l==f[idx]&&e.addClass("correct")})}};if(n["answers"].value==""){var s=new M.core.alert({title:this.heading,message:M.str.videoquiz.answervalidating,lightbox:!0});return!1}this._abortAnswer=!1,e.on("io:complete",i,e,[this.qpanel]);var o=e.io(this.form.action,{method:"POST",data:build_querystring(r)});this.setFooter(this.qpanel.footerHtml),e.one("div#correctstr").hide(),e.one("div#wrongstr").hide()},handleAbort:function(){this._abortAnswer=!0;var t={questionid:this.questionid,sesskey:M.cfg.sesskey,abort:!0},n=function(t,n,r){var t=t,i=n.responseText,s=r[0],o=e.one(s.qdialog.form),u=e.JSON.parse(n.responseText);if(u.abort){var a=e.one("span.progress");a&&a.hide();var f=u.rightanswer.split(",");e.one("span#qdialog_abort_close").removeClass("yui-button-disabled"),e.one("span#qdialog_abort_close").addClass("default"),s.abortCloseButton=new e.YUI2.widget.Button("qdialog_abort_close",{type:"submit"}),s.abortCloseButton.on("click",function(e,t,n){s.qdialog.hide(),s.fire("answer_abort")});for(idx in f)o.all("label").each(function(e){e.get("innerText")==f[idx]&&e.addClass("correct")})}};e.on("io:complete",n,e,[this.qpanel]);var r=e.io(this.form.action,{method:"POST",data:build_querystring(t)});this.setFooter(this.qpanel.abortFooterHtml)}}),M.mod_videoquiz.quesion_qdialog=M.mod_videoquiz.quesion_qdialog||{},M.mod_videoquiz.quesion_qdialog.init=function(e){var n={width:e.width,context:[e.hostid,"tl","tl",["windowResize"]],postmethod:"async"};return new t(e)}},"@VERSION@",{requires:["base","node","event-custom","yui2-container","yui2-event","yui2-connection","yui2-button"]}),YUI.add("option-add-remove",function(e){function t(e){t.superclass.constructor.apply(this,arguments)}t.NAME="VideoQuizAddRemove",t.ATTRS={addBtnNode:{},optionNodes:{},nodeList:{},targetNode:{},animate:{value:!1},templateString:""},e.extend(t,e.Base,{initializer:function(t){this.get("addBtnNode").on("click",this._add,this),arSelf=this,this.get("optionNodes").each(function(t){var n=t.getAttribute("opt-key");rmNode=e.Node.create('<span class="remove" id="remove'+n+'" opt-key='+n+"></span>"),rmNode.on("click",arSelf._remove,arSelf),t.append(rmNode)}),this.targetNode=t.targetNode,this.yNodeList=this.targetNode.all(".control-group"),this.nodeList=this.yNodeList._nodes},_add:function(t){var n=this.nodeList.length,r=M.str.videoquiz.option+n,i=M.str.videoquiz.itemplacehold,s=e.Node.create(String.format(this.get("templateString"),n,r,i,M.str.videoquiz.correctanswer));this.targetNode.append(s);var o=s.one("div.controls[id^=option]");rmNode=e.Node.create('<span class="remove" id="remove'+n+'" opt-key='+n+"></span>"),rmNode.on("click",this._remove,this),o.insert(rmNode),this.yNodeList.push(s)},_remove:function(e){var t=e.target.getAttribute("opt-key"),n=e.target;this._destroyNode(t)},_destroyNode:function(e){this.yNodeList._nodes[e].remove(),this.nodeList.splice(e,1)}}),e.addRemove=t},"@VERSION@",{requires:["node","base","anim"]}),function(e){var t=function(e){var t,n,r;for(n=1;n<arguments.length;n++){t=arguments[n];for(r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}return e},n={autoDisable:!1},r=function(e){var r=this,i=!1,s=t({},n,e||{});r.disableProgress={disable:function(){i=!0,r.controlBar.progressControl.seekBar.off("mousedown"),r.controlBar.progressControl.seekBar.off("touchstart"),r.controlBar.progressControl.seekBar.off("click")},enable:function(){i=!1,r.controlBar.progressControl.seekBar.on("mousedown",r.controlBar.progressControl.seekBar.onMouseDown),r.controlBar.progressControl.seekBar.on("touchstart",r.controlBar.progressControl.seekBar.onMouseDown),r.controlBar.progressControl.seekBar.on("click",r.controlBar.progressControl.seekBar.onClick)},getState:function(){return i}},s.autoDisable&&r.disableProgress.disable()};e.plugin("disableProgress",r)}(window.videojs),function(e){var t={image:"",destination:"#"},n=function(e){var n=videojs.util.mergeOptions(t,e),r=this,i=document.createElement("a");i.id="vjs-logobrand-image-destination",i.href=n.destination,i.target="_blank";var s=document.createElement("img");s.id="vjs-logobrand-image",s.style.position="absolute",s.style.top="4px",s.style.right="4px",s.src=n.image,i.appendChild(s),r.el().appendChild(i);var o=!0;return r.on("useractive",function(){o=!0,s.style.display=""}),r.on("userinactive",function(){o=!1,r.paused()||(s.style.display="none")}),r.on("pause",function(){s.style.display=""}),r.on("play",function(){o||(s.style.display="none")}),this.loadImage=function(e){document.getElementById("vjs-logobrand-image").src=e},this.setDestination=function(e){document.getElementById("vjs-logobrand-image-destination").href=e},this};e.plugin("logobrand",n)}(window.videojs),function(t){var n,r=function(){var e={className:"vjs-lock-button vjs-control",innerHTML:'<div class="vjs-control-content"><span class="vjs-control-text">Lock</span></div>',role:"button","aria-live":"polite",tabIndex:0};return videojs.Component.prototype.createEl(null,e)},i=t.Button.extend({init:function(e,t,n){videojs.Button.call(this,e,t),this.on("click",n)}});i.prototype.lock=function(){e.one(".vjs-control.vjs-unlock-button")._node.className="vjs-lock-button vjs-control"},i.prototype.unlock=function(){e.one(".vjs-control.vjs-lock-button")._node.className="vjs-unlock-button vjs-control"},t.plugin("unlock",function(e){var t={el:r()};n=new i(this,t,e),this.controlBar.el().appendChild(n.el())})}(window.videojs),function(e){var t,n=function(){var e={className:"vjs-addquestion-button vjs-control",innerHTML:'<div class="vjs-control-content"><span class="vjs-control-text">Lock</span></div>',role:"button","aria-live":"polite",tabIndex:0};return videojs.Component.prototype.createEl(null,e)},r=e.Button.extend({init:function(e,t,n){videojs.Button.call(this,e,t),this.on("click",n)}});e.plugin("addbutton",function(e){var i={el:n()};t=new r(this,i,e),this
.controlBar.el().appendChild(t.el())})}(window.videojs),M.mod_videoquiz=M.mod_videoquiz||{},M.mod_videoquiz.video={init:function(t,n,r,i,s,o){var u=videojs("videoquiz-"+t,{nativeControlsForTouch:!1,customControlsOnMobile:!0});u.videoquiz(t,s),u.ready(function(){e.one(".vjs-fullscreen-control").setStyle("display","none"),e.one(".vjs-volume-control").setStyle("margin-right","20px"),o&&(o.disableProgress&&u.disableProgress({autoDisable:!0}),o.canedit&&(u.unlock(function(){u.pause(),u.quiz.editmode==="off"?(u.quiz.editOn(),this.unlock(),u.disableProgress.enable(),u.quiz.untieCuepoint()):(u.quiz.editOff(),this.lock(),u.disableProgress.disable(),u.quiz.bindCuepoint())}),u.addbutton(function(){u.quiz.showEditDialog(-1)})))})},enableResize:function(e,t,n){function s(){var e=document.getElementById(r.id()).parentElement.offsetWidth;r.width(e).height(e*i)}var r=videojs("videoquiz-"+e),i=n/t;s(),window.onresize=s},showhide:function(e){var t=videojs("videoquiz-"+e);t.play(),t.pause(),t.quiz.editmode==="off"?t.quiz.editOn():t.quiz.editOff()},addquestion:function(e){var t=videojs("videoquiz-"+e);t.quiz.showEditDialog(-1)},savequiz:function(t){var n=videojs("videoquiz-"+t);e.use("io-base","io-form","json","querystring-stringify-simple",function(e){var r=function(){alert("success")},i=function(){alert("failure")},s="save.php";e.on("io:success",r),e.on("io:failure",i),e.io(s,{method:"POST",data:{id:t,questions:e.JSON.stringify(n.quiz.markers)}})})}}},"@VERSION@",{requires:["base","io-base","node","json-parse","event","editor"]});
